(()=>{"use strict";var e,o,n;!function(e){e.AVAILABLE="AVAILABLE",e.AWAY="AWAY",e.BUSY="BUSY",e.BUSY_DO_NOT_DISTURB="BUSY_DO_NOT_DISTURB",e.OFFLINE="OFFLINE"}(e||(e={})),function(e){e[e.Success=1]="Success",e[e.Error=2]="Error",e[e.Warning=3]="Warning",e[e.Information=4]="Information"}(o||(o={})),function(e){e[e.Active=2]="Active",e[e.WrapUp=5]="WrapUp",e[e.Closed=4]="Closed"}(n||(n={}));window.CCaaS=window.CCaaS||{},window.CCaaS.CTIDriver||(window.CCaaS.CTIDriver=new class{initialize(){return Promise.resolve(!0)}bindEvents(){!function(){const t=window.Microsoft.CCaaS.EmbedSDK;var s;t&&(t.conversation.onNotesAdded(e=>{console.log("Embed SDK New Note Created",e)}),t.conversation.onConversationLoaded(o=>{console.log("Embed SDK Conversation Loaded",o),window.parent.postMessage(o,"*"),(o=>{o.presence.getPresence().then(e=>{console.log("Embed SDK Agent's Current Presence:",e)}).catch(e=>{console.error("Embed SDK Failed to retrieve agent's presence status:",e)}),o.presence.getPresenceOptions().then(n=>{console.log("Embed SDK Available Presence Options:",n);const t=n.find(o=>o.basePresenceStatus===e.BUSY_DO_NOT_DISTURB);t?o.presence.setPresence(t.presenceId).then(()=>{console.log("Embed SDK Agent's presence status has been updated to 'busyDND'.")}).catch(e=>{console.error("Embed SDK Failed to update agent's presence status:",e)}):console.warn("Embed SDK 'busyDND' presence option not found.")}).catch(e=>{console.error("Embed SDK Failed to retrieve presence options:",e)})})(t),(e=>{e.conversation.getFocusedConversationId().then(e=>{console.log("Embed SDK getFocusedConversationId:  Focused Conversation ID:",e)}).catch(e=>{console.error("Embed SDK getFocusedConversationId:  Failed to retrieve focused conversation ID:",e)})})(t)}),t.conversation.onTransfer(e=>{console.log("Embed SDK Conversation Transferred",e)}),t.conversation.onStatusChange(e=>{console.log("Embed SDK Conversation State Changed",e),e.statusCode===n.Closed&&((e,o)=>{e.conversation.getTranscript(o).then(e=>{console.log("Embed SDK Transcript",e)}).catch(e=>{console.error("Embed SDK Failed to retrieve transcript:",e)})})(t,e.liveWorkItemId)}),t.conversation.onNewMessage(e=>{console.log("Embed SDK New Message",e)}),t.conversation.onAccept(e=>{console.log("Embed SDK Conversation Accepted",e),(e=>{const n={level:o.Information,message:"New conversation assigned to you!"};e.notification.addNewNotification(n).then(e=>{console.log("Embed SDK Notification added with ID:",e)}).catch(e=>{console.error("Embed SDK Failed to add notification:",e)})})(t),(e=>{e.conversation.getAssignedConversationsList(n.Active).then(e=>{console.log("Embed SDK getAssignedConversationsList: Assigned Conversations:",e)}).catch(e=>{console.error("Embed SDK getAssignedConversationsList: Failed to retrieve assigned conversations:",e)})})(t),((e,o)=>{e.conversation.getConversationData(o,["msdyn_ocliveworkitemid","msdyn_channel","statuscode","msdyn_createdon"]).then(e=>{console.log("Embed SDK Conversation data:",e)}).catch(e=>{console.error("Embed SDK Failed to retrieve conversation data:",e)})})(t,e.liveWorkItemId),((e,o)=>{e.dataverse.retrieveRecord("msdyn_ocliveworkitems",o,"?$select=msdyn_createdon").then(e=>console.log("Embed SDK  Retrieve record Response:",e)).catch(e=>console.error("Embed SDK Failed to retrieve record:",e))})(t,e.liveWorkItemId),((e,o)=>{const n=`<fetch top="50"><entity name="msdyn_ocliveworkitem"><attribute name="msdyn_ocliveworkitemid"/><attribute name="msdyn_channel"/><attribute name="statuscode"/><attribute name="msdyn_createdon"/><filter><condition attribute="msdyn_ocliveworkitemid" operator="eq" value="${o}"/></filter></entity></fetch>`;e.dataverse.retrieveMultipleRecords("msdyn_ocliveworkitems",`?fetchXml=${n}`).then(e=>console.log("Embed SDK  Retrieve multiple records Response:",e)).catch(e=>console.error("Embed SDK Failed to retrieve multiple records:",e))})(t,e.liveWorkItemId)}),t.conversation.onReject(e=>{console.log("Embed SDK Conversation Rejected",e)}),t.conversation.onConsultStart(e=>{console.log("Embed SDK Consult Started",e)}),t.conversation.onConsultEnd(e=>{console.log("Embed SDK Consult Ended",e)}),t.conversation.onCustomerSentimentChange(e=>{console.log("Embed SDK Customer Sentiment Changed",e)}),t.notification.onNewConversationNotification(e=>{console.log("Embed SDK New Conversation Notification",e)}),t.conversation.onNewMessage(e=>{console.log("Embed SDK New Message",e)}),t.notification.onNewNotification(e=>{console.log("Embed SDK New Notification",e)}),t.presence.onPresenceChange(e=>{console.log("Embed SDK Agent Presence Changed",e)}),t.voiceOrVideoCalling.onHoldChange(e=>{console.log("Embed SDK Call hold changed",e)}),t.voiceOrVideoCalling.onMuteChange(e=>{console.log("Embed SDK Call mute changed",e)}),t.ctiDriver.onSoftPhonePanelHeightChange(e=>{(()=>{throw new Error("Method not implemented.")})()}),t.ctiDriver.onSoftPhonePanelWidthChange(e=>{(()=>{throw new Error("Method not implemented.")})()}),t.ctiDriver.onSoftPhonePanelVisibilityChange(e=>{(()=>{throw new Error("Method not implemented.")})()}),s=t.ctiDriver.clickToDial,window.addEventListener("message",e=>{const{messageType:o,messageData:n}=JSON.parse(e.data);if(o&&"clickToDial"===o){const e={number:n.number};s(e)}}))}()}static loadScript(e){return new Promise((o,n)=>{const t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=e,t.onload=function(){o(!0)},t.onerror=function(){o(!0)},document.getElementsByTagName("head")[0].appendChild(t)})}})})();
